---
- name: List ip address of tempest node
  hosts: tempest
  roles:
    - { role: tempest/iptables/node_data }
  tags:
    - tempest_setup

- name: Ensure iptables is open for tempest
  hosts: all:!localhost:!tempest
  roles:
    - { role: tempest/iptables }
  tags:
    - tempest_setup

- include: ../tempest.yml

# The 'tempest_rhosqe' and 'tempest_setup,tempest_run' tags are mutually
# exclusive. Since this setup requires that tempest runs from the controller,
# we're using the 'controller' host and ignoring any extra tempest node.
- name: Setup and run tempest using temporary Red Hat internal tools
  hosts: controller
  tags: tempest_rhosqe
  roles:
    - { role: tempest_rhosqe }

