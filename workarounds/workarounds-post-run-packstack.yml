---
- name: Workarounds | specific to RedHat distro RHEL 7.x
  hosts: RedHat-7:&controller
  roles:
     - { role: workarounds/rabbitmq-server,
         tags: workaround,
         when: workaround_rhel7_rabbitmq_run_dir|default(false) }

- name: Workarounds | specific to Controllers (roles)
  hosts: controller
  roles:
    - { role: common-handlers, tags: workaround }
    - { role: workarounds/vif_plugging,
          tags: workaround,
          when: workaround_vif_plugging | default(false) }
    - { role: workarounds/default-floating-pool,
          when: workarounds.enabled and workaround.default_floating_pool is defined and workaround.default_floating_pool }
    - { role: workarounds/nova-objectstore-install,
          when: workarounds.enabled and workaround.nova_objectstore_install is defined and workaround.nova_objectstore_install }
    - { role: workarounds/s3-objectstore-endpoint,
          when: workarounds.enabled and workaround.s3_objectstore_endpoint is defined and workaround.s3_objectstore_endpoint }
    - { role: workarounds/nova-scheduler-default-filters,
          when: workarounds.enabled and workaround.nova_scheduler_default_filters is defined and workaround.nova_scheduler_default_filters }

- name: Workarounds | specific to Compute nodes (roles)
  hosts: compute
  roles:
    - { role: workarounds/set-key-encrypted-volumes,
        tags: workarounds,
        when: workarounds.enabled and workaround.set_key_encrypted_volumes is defined and workaround.set_key_encrypted_volumes }
