- name: rpm | repo used
  debug: msg="using tempest repo {{ tempest_rpm_repo }}" #"
  tags: tempest_setup_rpm

- name: rpm | create the tempest Repository
  template: src=tempest.repo.j2 dest=/etc/yum.repos.d/tempest.repo
  sudo: yes
  tags:
    - tempest_setup_rpm
  notify:
    - Yum clean all
    - Yum repolist

- meta: flush_handlers

- name: rpm | install tempest rpm
  command: yum install -y openstack-tempest-icehouse
  sudo: yes
  tags: tempest_setup_rpm

- name: rpm | get tempest install directory
  shell: rpm -ql openstack-tempest-icehouse | grep 'openstack-tempest-icehouse$'
  register: tempest_install_dir
  tags: tempest_setup_rpm

- debug: msg="{{ tempest_install_dir.stdout }}"
  tags: tempest_setup_rpm

- debug: msg="{{ tempest.dir }}"
  tags: tempest_setup_rpm

- name: rpm | create tempest.dir
  file: path="{{ tempest.dir }}" state=directory

- include: generate-tempest-conf.yml
