---
- name: Install rdo-release
  yum: name="{{ rdo[ config.version ].release_rpm[ ansible_distribution ] }}"
       state=present

- name: Turn off gpgcheck
  ini_file: dest=/etc/yum.repos.d/rdo-release.repo
            section=openstack-{{ config.version }}
            option=gpgcheck
            value=0

- name: Turn off foreman repo
  ini_file: dest=/etc/yum.repos.d/foreman.repo
            section=foreman
            option=enabled
            value=0
  notify:
    - Yum clean all

- name: List available yum repositories
  command: yum -d 7 repolist
  register: result

- name: Print repolist
  debug: var=result.stdout_lines

- name: Install rpm dependencies
  yum: name={{ item }} state=present
  with_items:
    - gcc
    - libxml2-devel
    - libxslt-devel
    - libffi-devel
    - git
    - python-pip
    - packstack-modules-puppet
    - python-keystoneclient
    - python-novaclient
    - python-glanceclient
    - python-neutronclient
    - facter
    - puppet
  tags:
    - tempest_setup
