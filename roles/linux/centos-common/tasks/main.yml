---
#CENTOS

- name: Ensure centos-release
  yum: name=centos-release state=present

- name: Remove all yum repositories
  file: path=/etc/yum.repos.d/*.repo state=absent

- name: Create the CentOS Repositories
  template: src=CentOS-Base.repo.j2 dest=/etc/yum.repos.d/CentOS-Base.repo

- name: Create the EPEL Repository
  template: src=epel.repo.j2 dest=/etc/yum.repos.d/epel.repo

- name: Yum clean all
  command: yum clean all

- name: Ensure httplib2
  yum: name=python-httplib2 state=present

- name: yum -y update to latest packages
  yum: name=* state=latest
  notify:
      - reboot
      - Wait for host to stop
      - Wait for host to come back
      - Reload facts

- meta: flush_handlers
