---
# cloud-init and python-backports can interfere w/ openstack installs
- name: remove cloud-init and python-backports
  yum: name={{ item }} state=absent
  with_items:
    - python-backports
    - cloud-init

- debug: msg="run packstack installer"
  tags: run-packstack

- name: Packstack | run
  register: result
  command: packstack --debug --answer-file={{ packstack_config }}
  sudo: yes
  sudo_user: root
  retries: 1
  until: result.rc == 0
  tags: run-packstack
